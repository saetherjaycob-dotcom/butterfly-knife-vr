<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Butterfly Knife VR</title>
<script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
</head>

<body>
<a-scene xr-mode-ui="enabled: true">

<a-entity camera look-controls position="0 1.6 0"></a-entity>

<a-entity id="hand"
  laser-controls="hand: right"
  knife-control>
</a-entity>

<a-plane rotation="-90 0 0" width="8" height="8" color="#222"></a-plane>

<a-box id="handle"
  position="0 1.4 -1"
  width="0.05"
  height="0.15"
  depth="0.03"
  color="#444">
</a-box>

<a-box id="blade"
  position="0 1.55 -1"
  width="0.01"
  height="0.18"
  depth="0.02"
  color="#ccc">
</a-box>

<script>
AFRAME.registerComponent('knife-control', {
  init() {
    this.blade = document.querySelector('#blade')
    this.open = false
    window.addEventListener('triggerdown', () => this.toggle())
  },

  tick() {
    const x = this.el.object3D.rotation.x
    this.blade.object3D.rotation.x = x * 2
  },

  toggle() {
    this.open = !this.open
    this.blade.object3D.rotation.x = this.open ? Math.PI : 0
  }
})
</script>

</a-scene>
</body>
</html>
